openNav = () => { if (document.querySelector('#hamburger-animate').classList.contains('is-active') === true) { document.querySelector('#hamburger-animate').classList.remove('is-active'); document.querySelector('#mySidenav').style.width = '0'; document.querySelector('#main').style.marginLeft = '0'; } else { document.querySelector('#hamburger-animate').classList.toggle('is-active'); document.querySelector('#mySidenav').style.width = '250px'; document.querySelector('#main').style.marginLeft = '250px'; } }; closeOverlay = () => { document.getElementById("myNav").style.width = "0%"; }
snackbar = (message) => { var notify = document.querySelector('#snackbar'); notify.innerText = message; notify.className = 'show'; setTimeout(function () { notify.className = notify.className.replace('show', ''); }, 3000); }; var app = angular.module('visualhelpers-app', ['ngRoute']); var uriApi = 'http://schi-iis1zem/ZCUU_VisualHelpers'; var errorMessage = 'Ocurrio un error! El servidor dejo de responder, intente de nuevo.'; app.config(function ($routeProvider) { $routeProvider.when('/Visor', { templateUrl: 'Visor' }).when('/Actions', { templateUrl: 'Action' }).when('/Steps', { templateUrl: 'Steps' }).otherwise({ templateUrl: 'Visor' }); }); app.controller('visor-controller', ($scope, $http) => {
    document.querySelector('#player').addEventListener('ended', () => {
        bootbox.confirm("Te aseguraste de los revisar las especificaciones de cada paso?", function (result) {
            if (result === false) { var video = document.querySelector('#player'); video.play(); }
            else { $http.get(`${uriApi}/api/Video?action=${localStorage.getItem('action')}&item=${localStorage.getItem('item')}`).then((response) => { var video = document.querySelector('#player'); video.setAttribute('src', `${uriApi}/Content/uploads/${response.data.Media}`); }); }
        });
    }); $http.get(`${uriApi}/api/ActionSteps`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.steps = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); $http.get(`${uriApi}/api/ActionGroups`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.actions = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); $scope.openOverlay = (e) => { document.getElementById("myNav").style.width = "100%"; document.querySelector('#breadcrumb').innerHTML = '<ion-icon name="browsers"></ion-icon> Ayudas Visuales'; document.querySelector('#breadcrumb').classList.add('animated', 'fadeInLeft'); $http.get(`${uriApi}/api/Overlay/${e}`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.steps = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }; $scope.showMedia = (e) => { $http.get(`${uriApi}/api/ActionSteps/${e}`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); localStorage.setItem('action', response.data.ActionGroupId); localStorage.setItem('item', response.data.Id); $scope.mediaURL = `${uriApi}/Content/uploads/${response.data.Media}`; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); };
}); app.controller('actions-controller', ($scope, $http) => { document.querySelector('#breadcrumb').innerHTML = '<ion-icon name="browsers"></ion-icon> Acciones'; document.querySelector('#breadcrumb').classList.add('animated', 'fadeInLeft'); $http.get(`${uriApi}/api/ActionGroups`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.actions = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); $scope.select = (id) => { $http.get(`${uriApi}/api/ActionGroups/${id}`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.idAction = response.data.Id; $scope.descriptionAction = response.data.Description; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }; $scope.addorupdate = () => { if ($scope.actionForm.$valid) { $http.post(`${uriApi}/api/ActionGroups`, { Id: $scope.idAction, Description: $scope.descriptionAction }).then((response) => { snackbar('Datos Guardados'); $scope.idAction = null; $scope.descriptionAction = null; $http.get(`${uriApi}/api/ActionGroups`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.actions = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }).catch((error) => { snackbar(errorMessage) }); } }; $scope.delete = (id) => { bootbox.confirm('Esta seguro de eliminar el registro?', function (result) { if (result === true) { $http.delete(`${uriApi}/api/ActionGroups/${id}`).then((response) => { snackbar('Datos Eliminados'); $scope.idAction = null; $scope.descriptionAction = null; $http.get(`${uriApi}/api/ActionGroups`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.actions = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }).catch((error) => { snackbar(errorMessage) }); } }); }; }); app.controller('steps-controller', ($scope, $http) => { document.querySelector('#breadcrumb').innerHTML = '<ion-icon name="browsers"></ion-icon> Pasos'; document.querySelector('#breadcrumb').classList.add('animated', 'fadeInLeft'); $http.get(`${uriApi}/api/ActionSteps`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.steps = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); $http.get(`${uriApi}/api/ActionGroups`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.actions = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); var mediaFile = null; document.querySelector('#inputGroupFile').addEventListener('change', (ev) => { var arch = new FileReader(); arch.addEventListener('load', (rv) => { file64 = rv.target.result; mediaFile = file64; }, false); arch.readAsDataURL(ev.target.files[0]); }, false); $scope.select = (id) => { $http.get(`${uriApi}/api/ActionSteps/${id}`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); indexAction = $scope.actions.findIndex(q => q.Id === response.data.ActionGroupId); $scope.actionStep = $scope.actions[indexAction]; $scope.idStep = response.data.Id; $scope.orderStep = response.data.Order; $scope.titleStep = response.data.Title; $scope.descriptionStep = response.data.Description; $scope.mediaURL = `${uriApi}/Content/uploads/${response.data.Media}`; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }; $scope.addorupdate = () => { if ($scope.stepForm.$valid) { $http.post(`${uriApi}/api/ActionSteps`, { Id: $scope.idStep, ActionGroupId: $scope.actionStep.Id, Order: $scope.orderStep, Title: $scope.titleStep, Description: $scope.descriptionStep, Media: mediaFile }).then((response) => { snackbar('Datos Guardados'); $scope.idStep = null; $scope.descriptionAction = null; $http.get(`${uriApi}/api/ActionSteps`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.steps = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }).catch((error) => { snackbar(errorMessage) }); } }; $scope.delete = (id) => { bootbox.confirm('Esta seguro de eliminar el registro?', function (result) { if (result === true) { $http.delete(`${uriApi}/api/ActionSteps/${id}`).then((response) => { snackbar('Datos Eliminados'); $scope.idStep = null; $scope.actionStep = null; $scope.orderStep = null; $scope.titleStep = null; $scope.descriptionStep = null; $http.get(`${uriApi}/api/ActionSteps`).then((response) => { setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeInLeft'); }, 1000); $scope.steps = response.data; setTimeout(() => { document.querySelector('.actionbar').classList.add('animated', 'fadeOutLeft'); }, 3000); }).catch((error) => { snackbar(errorMessage) }); }).catch((error) => { snackbar(errorMessage) }); } }); }; });